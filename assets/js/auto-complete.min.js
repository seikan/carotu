!function(e){e.fn.autoComplete=function(t){var o=[],n="object"==typeof t?t:{},i=e.extend({source:[],noResults:"No result found"},n),a=function(t){if(e(t).is("input")&&Array.isArray(i.source)){o.push(t);var n=e('<ul class="dropdown-menu shadow auto-complete">'),a=e('<div class="w-100 overflow-x-hidden overflow-y-auto">'),s=function(){n.removeClass("show")};e(document).on("keydown",(function(o){var n=a.find("a");switch(o.which){case 27:s();break;case 38:if(!e(t).is(":focus")){o.preventDefault();break}0===a.find("li a.active").length?e(n[0]).addClass("active"):e.each(n,(function(t,o){if(e(o).hasClass("active")){var i=e(n[(0===t?n.length:t)-1]);return e(o).removeClass("active"),i.addClass("active"),(i.position().top<4*i.outerHeight()||i.position().top>2*a[0].clientHeight-2*i.outerHeight())&&i[0].scrollIntoView(),!1}}));break;case 40:if(!e(t).is(":focus")){o.preventDefault();break}0===a.find("a.active").length?e(n[0]).addClass("active"):e.each(n,(function(t,o){if(e(o).hasClass("active")){var i=e(n[(t===n.length-1?-1:t)+1]);e(o).removeClass("active"),i.addClass("active");var s=Math.ceil(a[0].clientHeight/i.outerHeight());return(i.position().top>i.outerHeight()*s||i.position().top<0)&&i[0].scrollIntoView(),!1}}));break;default:}})),n.append(a),e(t).on("input",(function(){a.empty(),i.source.length>0&&e.each(i.source,(function(o,i){if(i.toLowerCase().includes(e(t).val().trim().toLowerCase())){if(0==i.length)return;var s=e('<a href="#" class="dropdown-item">').html(i.replace(new RegExp("("+e(t).val().trim()+")","ig"),"<strong>$1</strong>")).on("click",(function(o){o.preventDefault(),e(t).val(i),n.removeClass("show")}));a.append(e("<li>").append(s))}})),a.is(":empty")&&a.append(e("<li>").append('<a href="#" class="dropdown-item disabled">'+i.noResults+"</a>")),function(){n.css({width:e(t).outerWidth()}).addClass("show"),n.offset({top:e(t).offset().top+e(t).outerHeight()});var o=e(window).height()-(e(t).offset().top+e(t).outerHeight()+100);o=o>300?300:o,a.css({maxHeight:o})}()})).on("blur",(function(){setTimeout((function(){s()}),200)})).on("keypress",(function(e){13===e.which&&(e.preventDefault(),a.find("a.active").trigger("click"))})).on("keydown",(function(e){9===e.which&&(e.preventDefault(),a.find("a.active").trigger("click"))})).after(n),e(document).on("wheel",(function(){e(t).blur()}))}};return destroy=function(){e.each(o,(function(t,o){e(o).off("input blur keypress keydown"),e(o).next(".auto-complete").remove()}))},refresh=function(){destroy(),e.each(o,(function(e,t){a(t)}))},this.each((function(e,t){a(t)})),{destroy:destroy,refresh:refresh}}}(jQuery);