!function(e){e.fn.selectSearch=function(a){e.each(this,(function(a,t){var s=e(t).attr("class").split(" "),i=e(t).find("option:selected").text(),o=e('<ul class="dropdown-menu shadow">'),l=e('<input type="text" class="form-control select-search-input" autocomplete="off" autocapitalize="off">'),n=void 0!==e(t).data("search"),c=e('<div class="w-100 overflow-x-hidden overflow-y-scroll">');n&&(l.on("input",(function(){u()})).on("keypress",(function(e){13===e.which&&c.find("a.active").trigger("click")})).on("keydown",(function(e){9===e.which&&c.find("a.active").trigger("click")})),o.append(e('<li class="p-2">').append(l))),o.append(c),s.push("select-search");var r=e('<div class="'+s.join(" ")+'">').css({height:e(t).outerHeight()}).html('<div class="overflow-hidden text-nowrap">'+(i.length>0?i:"&nbsp;")+"</div>").on("click",(function(){e(this).hasClass("disabled")||(e(this).addClass("focus"),o.hasClass("show")?h():(v(),u()))}));e(t).addClass("d-none").after(r,o),e(t).on("change",(function(){r.data("value",e(this).val()).find("div").html(e(this).find("option:selected").html())})),e(document).on("mouseup",(function(e){r.is(e.target)||l.is(e.target)||c.is(e.target)||(r.removeClass("focus"),o.removeClass("show"))})),e(document).on("keydown",(function(a){var t=c.find("a");switch(a.which){case 27:h();break;case 38:if(!r.hasClass("focus"))return void a.preventDefault();v(),0===c.find("li a.active").length?e(t[0]).addClass("active"):e.each(t,(function(a,s){if(e(s).hasClass("active")){var i=e(t[(0===a?t.length:a)-1]);e(s).removeClass("active"),i.addClass("active");var o=i.position().top+c.scrollTop()-2*i.outerHeight();return(o>c.scrollTop()+c.outerHeight()||o<c.scrollTop())&&c.scrollTop(c.scrollTop()+i.position().top-2*i.outerHeight()),!1}}));break;case 40:if(!r.hasClass("focus")){a.preventDefault();break}v(),0===c.find("a.active").length?e(t[0]).addClass("active"):e.each(t,(function(a,s){if(e(s).hasClass("active")){var i=e(t[(a===t.length-1?-1:a)+1]);e(s).removeClass("active"),i.addClass("active");var o=i.position().top+c.scrollTop()-i.outerHeight();return(o>c.scrollTop()+c.outerHeight()||o<c.scrollTop())&&c.scrollTop(c.scrollTop()+i.position().top-2*i.outerHeight()),!1}}));break;default:}}));var d=new MutationObserver((function(a){for(var t,s=0;t=a[s];s++)"disabled"==t.attributeName&&(t.target.disabled?r.addClass("disabled"):r.removeClass("disabled")),"class"==t.attributeName&&(e(t.target).hasClass("is-invalid")?r.addClass("is-invalid"):r.removeClass("is-invalid"))}));d.observe(t,{attributes:!0});var v=function(){o.css({width:r.outerWidth()}).addClass("show"),l&&l.val("").focus();var a=e(window).height()-(r.offset().top+r.outerHeight()+100);a=a>300?300:a,c.css({maxHeight:a})},h=function(){o.removeClass("show")},u=function(){c.empty();var a=0;if(e.each(e(t).find("option"),(function(s,i){if(i.text.toLowerCase().includes(l.val().trim().toLowerCase())){if(0==i.text.length)return void a++;var n=e('<a href="#" class="dropdown-item" data-value="'+i.value+'">').html(i.text).on("click",(function(a){a.preventDefault(),e(t).val(i.value),r.data("value",i.value).find("div").html(i.text),o.removeClass("show")}));l.val().length>0?0===a&&n.addClass("active"):e(t).val()===i.value&&n.addClass("active"),c.append(e('<li class="select-search-item'+(r.data("value")===i.value?" active":"")+'">').append(n)),a++}})),c.find("a.active")){var s=c.find("a.active");s.length>0&&c.scrollTop(c.scrollTop()+s.position().top-2*s.outerHeight())}}}))}}(jQuery);