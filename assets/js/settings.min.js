class Settings{constructor(){var e=this;$("#menu-settings").on("click",(function(e){e.preventDefault(),$("#modal-settings").modal("show")})),$("#modal-settings").on("show.bs.modal",(function(){$.cookie("theme")&&$('select[name="theme"]').val($.cookie("theme")),$.cookie("page-length")&&$('select[name="page-length"]').val($.cookie("page-length")),e.refreshCurrencyList()})),$('select[name="theme"]').on("change",(function(){$.cookie("theme",$(this).val()),window.location.href=window.location.href})),$('select[name="page-length"]').on("change",(function(){$.cookie("page-length",$(this).val()),window.location.href=window.location.href})),$("#btn-add-currency").on("click",(function(t){t.preventDefault(),e.refreshCurrencyList();var n=$("<tr>").append('<td><input type="text" name="code" value="" class="form-control form-control-sm" maxlength="3"></td>').append('<td><input type="text" name="rate" value="" class="form-control form-control-sm text-end"></td>'),a=$('<i class="bi bi-check pointer me-2">').on("click",(function(t){t.preventDefault(),n.find(".is-invalid").removeClass("is-invalid"),$.post("./currency.json",{new:n.find('input[name="code"]').val(),rate:n.find('input[name="rate"]').val(),__CSRF_TOKEN__:$('input[name="__CSRF_TOKEN__"]').val()},(function(t){Object.keys(t.errors).length>0?$.each(t.errors,(function(e){n.find('input[name="'+e+'"]').addClass("is-invalid")})):e.refreshCurrencyList()})).fail((function(){alert("Connection lost, please try again.")})).always((function(e){$('input[name="'+e.csrf.name+'"]').val(e.csrf.value)}))})),o=$('<i class="bi bi-x pointer">').on("click",(function(e){e.preventDefault(),n.remove()}));$("#table-currency tbody").prepend(n.append($('<td class="text-end">').append(a).append(o)))}))}refreshCurrencyList(){var e=this;$("#table-currency tbody").empty(),$.get("./currency.json",(function(t){t.length>0&&$.each(t,(function(t,n){var a=$('<tr class="display">'),o=$('<tr class="edit d-none">').append('<td><input type="text" name="code" value="'+n.currency_code+'" data-value="'+n.currency_code+'" class="form-control form-control-sm" maxlength="3"></td>').append('<td><input type="text" name="rate" value="'+n.rate+'" data-value="'+n.rate+'" class="form-control form-control-sm text-end"></td>'),r=$('<i class="bi bi-pencil-square pointer me-2">').on("click",(function(e){e.preventDefault(),$("#table-currency tr.display").toggleClass("d-none",!1),$("#table-currency tr.edit").toggleClass("d-none",!0),a.toggleClass("d-none",!0),o.toggleClass("d-none",!1)})),s=$('<i class="bi bi-trash pointer">').on("click",(function(e){e.preventDefault();var t=$('<div class="dropdown-menu dropdown-confirm show">'),o=$('<div class="overlay position-absolute top-0 start-0 opacity-50 bg-light w-100 h-100">'),r=$('<div class="p-2">').append('<h6>Confirm to delete <span class="text-danger"><strong>'+n.currency_code+"</strong></span>?</h6>"),s=$('<button class="btn btn-sm btn-outline-secondary" style="padding:.1rem 1rem;margin-right:.5rem">').html("No").on("click",(function(e){e.preventDefault(),o.remove(),$("#currency-list").addClass("overflow-auto").removeClass("overflow-hidden"),$(this).closest("tr").removeClass("table-light"),t.remove()})),i=$('<button class="btn btn-sm btn-danger" style="padding:.1rem 1rem">').html("Yes").on("click",(function(e){e.preventDefault(),o.remove(),$("#currency-list").addClass("overflow-auto").removeClass("overflow-hidden"),$(this).closest("tr").removeClass("table-light"),a.closest("tr").remove(),a.remove(),$.post("./currency.json",{action:"delete",code:n.currency_code,__CSRF_TOKEN__:$('input[name="__CSRF_TOKEN__"]').val()},(function(){})).fail((function(){alert("Connection lost, please try again.")})).always((function(e){$('input[name="'+e.csrf.name+'"]').val(e.csrf.value)}))}));$(".dropdown-confirm").remove(),$(this).after(t.append(r).append($('<div class="mt-1 text-center">').append(s).append(i))),t.offset({top:$(this).offset().top+$(this).outerHeight()-t.outerHeight(),left:$(this).offset().left-$(this).outerWidth()-t.outerWidth()}),$("#currency-list").removeClass("overflow-auto").addClass("overflow-hidden").prepend(o),$(this).closest("tr").addClass("table-light")})),i=$('<i class="bi bi-check pointer me-2">').on("click",(function(t){t.preventDefault(),o.find(".is-invalid").removeClass("is-invalid"),$.post("./currency.json",{code:n.currency_code,new:o.find('input[name="code"]').val(),rate:o.find('input[name="rate"]').val(),__CSRF_TOKEN__:$('input[name="__CSRF_TOKEN__"]').val()},(function(t){Object.keys(t.errors).length>0?$.each(t.errors,(function(e){o.find('input[name="'+e+'"]').addClass("is-invalid")})):e.refreshCurrencyList()})).fail((function(){alert("Connection lost, please try again.")})).always((function(e){$('input[name="'+e.csrf.name+'"]').val(e.csrf.value)}))})),l=$('<i class="bi bi-x pointer">').on("click",(function(e){e.preventDefault(),o.find('input[name="code"]').val(o.find('input[name="code"]').data("value")),o.find('input[name="rate"]').val(o.find('input[name="rate"]').data("value")),o.find(".is-invalid").removeClass("is-invalid"),a.toggleClass("d-none",!1),o.toggleClass("d-none",!0)}));"USD"==n.currency_code?(a.append('<td class="text-muted"><strong>'+n.currency_code+"</strong></td>").append('<td class="text-end text-muted"><strong>'+n.rate+"</strong></td>").append('<td class="text-end">&nbsp;</td>'),$("#table-currency tbody").append(a)):(a.append("<td>"+n.currency_code+"</td>").append('<td class="text-end">'+n.rate+"</td>").append($('<td class="text-end">').append(r).append(s)),$("#table-currency tbody").append(a),$("#table-currency tbody").append(o.append($('<td class="text-end">').append(i).append(l))))}))})).fail((function(){alert("Connection lost, please try again.")}))}}