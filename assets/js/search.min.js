!function(e){e.fn.search=function(t){var a=[],i={Bandwidth:{operators:{Equals:"=","Greater Than":">","Less Than":"<"},unit:"GB",description:"<code>number</code> <strong>GB</strong>"},City:{operators:{Contains:":",Equals:"="},description:"<code>text</code>"},Country:{operators:{Contains:":",Equals:"="},description:"<code>ISO 3166-2 code or country name</code>"},"CPU Core":{operators:{Equals:"=","Greater Than":">","Less Than":"<"},description:"<code>number</code>"},"CPU Speed":{operators:{Equals:"=","Greater Than":">","Less Than":"<"},unit:"MHz",description:"<code>number</code> <strong>MHz</strong>"},"Disk Type":{operators:{Equals:"="},values:variables.diskTypes,description:""},"Disk Space":{operators:{Equals:"=","Greater Than":">","Less Than":"<"},unit:"GB",description:"<code>number</code> <strong>GB</strong>"},"IP Address":{operators:{Contains:":",Equals:"="},description:"<code>text</code>"},Label:{operators:{Contains:":",Equals:"="},description:"<code>text</code>"},NAT:{operators:{Equals:"="},values:["Yes","No"],description:""},Provider:{operators:{Contains:":",Equals:"="},description:"<code>text</code>"},RAM:{operators:{Equals:"=","Greater Than":">","Less Than":"<"},unit:"MB",description:"<code>number</code> <strong>MB</strong>"},Virtualization:{operators:{Equals:"="},values:variables.virtualizations,description:""},Visibility:{operators:{Equals:"="},values:["All","Visible","Hidden"],description:""}},n=e.extend({},{placeholder:"",onFilterChanged:function(){}},t),o=e('<ul class="dropdown-menu shadow">'),r=e('<input type="text" class="form-control" placeholder="'+n.placeholder+'" autocomplete="off" autocapitalize="off">').on("focus",(function(){c(),p()})).on("blur",(function(){setTimeout((function(){r.is(":focus")||d()}),200)})).on("keypress",(function(e){13===e.which&&(e.preventDefault(),h())})).on("keydown",(function(e){9===e.which&&(e.preventDefault(),h())})).on("input",(function(){s.toggleClass("d-none",!r.val()),p()})),s=e('<i class="bi bi-x-lg d-none"></i>').on("click",(function(){r.val(""),e(this).addClass("d-none")})),l=e('<div class="filter-list mt-2">'),c=function(){o.toggleClass("show",!0)},d=function(){o.toggleClass("show",!1)},p=function(){if(o.toggleClass("show",!0).empty(),r.val().length>0){var t=e('<a class="dropdown-item" href="#">').html('<div style="max-width: 300px; white-space: pre-wrap; word-wrap: break-word; word-break: break-word"><strong>Search: </strong>'+r.val()+"</div>").on("click",(function(){u("Search",":",r.val(),""),f(),r.val("").trigger("input"),d()}));o.append(e('<li class="filter-item filter-search">').append(t))}e.each(i,(function(t,a){var i=!1;if(t.toLowerCase().includes(r.val().toLowerCase())||r.val().toLowerCase().includes(t.toLowerCase()))if(0==o.find(".dropdown-header").length&&o.append('<li><h5 class="dropdown-header">Filters</h5></li>'),t.toLowerCase()!=r.val().toLowerCase()){if(e.each(a.operators,(function(n,s){if(r.val().toLowerCase().includes(t.toLowerCase()+" "+s)){if(void 0!==a.values)e.each(a.values,(function(i,n){var l=e('<a class="dropdown-item" href="#">').html("<strong>"+t+"</strong> "+s+" "+n).on("click",(function(e){e.preventDefault(),r.val("").trigger("input"),u(t,s,n,void 0!==a.unit?a.unit:""),f(),d()}));o.append(e('<li class="filter-item">').append(l))}));else{var l=e('<a class="dropdown-item" href="#">').html("<strong>"+t+"</strong> "+s+" "+a.description).on("click",(function(e){r.focus(),e.preventDefault()}));o.append(e('<li class="filter-item">').append(l))}return i=!0,!1}})),i)return!1;var n=e('<a class="dropdown-item" href="#">').html(t.replace(new RegExp("("+r.val()+")","ig"),"<code>$1</code>")).on("click",(function(e){e.preventDefault(),r.val(t).trigger("input").focus(),p()}));o.append(e('<li class="filter-item">').append(n))}else e.each(a.operators,(function(a,i){var n=e('<a class="dropdown-item" href="#">').html(t.replace(new RegExp("("+r.val()+")","ig"),"<code>$1</code> "+i+'<small class="d-block">'+a+"</small>")).on("click",(function(e){e.preventDefault(),r.val(t+" "+i+" ").trigger("input").focus()}));o.append(e('<li class="filter-item">').append(n))}))}))},u=function(t,i,o,r){var s=!1;0!==(o=o.replace(/;/g,"").trim()).length&&(Object.keys(a).length>0&&e.each(a,(function(e,a){if(a.filter==t&&a.operator==i&&a.value==o)return s=!0,!1})),s||(a.push({filter:t,operator:i,value:o,unit:r}),n.onFilterChanged(a)))},f=function(){if(l.empty(),Object.keys(a).length>0){e.each(a,(function(t,i){var o=e('<i class="bi bi-x">').on("click",(function(){var t,o,r;t=i.filter,o=i.operator,r=i.value,Object.keys(a).length>0&&e.each(a,(function(e,i){if(i.filter==t&&i.operator==o&&i.value==r)return a.splice(e,1),!1})),f(),n.onFilterChanged(a)}));l.append(e('<span class="badge text-bg-warning me-1">').html(i.filter+" "+i.operator+" "+i.value+(void 0!==i.unit?" "+i.unit:"")).append(o))}));var t=e('<button class="btn btn-sm btn-outline-warning p-0 px-1 mt-1 float-end" type="button">').html('<i class="bi bi-x-circle-fill"></i> Clear Filters').on("click",(function(){a=[],r.val("").trigger("input"),f(),n.onFilterChanged(a),d()}));l.append(t).append('<div class="clearfix"></div>')}},h=function(){if(0==o.find("li.filter-item a.active").length){var t=!1;e.each([":","=","<",">"],(function(a,n){if(r.val().includes(n)){var o=r.val().split(n),s=!1,l="";return t=!0,e.each(i,(function(t,a){o[0].trim()==t&&e.each(a.operators,(function(e,t){if(n==t&&o[1].trim().length>0)return s=!0,l=void 0!==a.unit?a.unit:"",!1}))})),s&&u(o[0].trim(),n,o[1].trim(),l),f(),r.val("").trigger("input"),d(),!1}})),!t&&r.val().length>0&&(u("Search",":",r.val(),""),f(),r.val("").trigger("input"),d())}else o.find("li.filter-item a.active").trigger("click")};this.addClass("d-none").after(e('<div class="search">').append('<i class="bi bi-search"></i>').append(r).append(s).append(o).append(l)),e(document).on("keydown",(function(t){switch(t.which){case 27:t.preventDefault(),d();break;case 38:o.hasClass("show")&&t.preventDefault();var a=o.find("li.filter-item a");0==o.find("li.filter-item a.active").length?e(a[0]).text()?e(a[0]).addClass("active"):e(a[1]).addClass("active"):e.each(a,(function(t,i){if(e(i).hasClass("active"))return e(i).removeClass("active"),e(a[(0==t?a.length:t)-1]).addClass("active"),!1}));break;case 40:o.hasClass("show")&&t.preventDefault();a=o.find("li.filter-item a");0==o.find("li.filter-item a.active").length?e(a[0]).text()?e(a[0]).addClass("active"):e(a[1]).addClass("active"):e.each(a,(function(t,i){if(e(i).hasClass("active"))return e(i).removeClass("active"),e(a[(t==a.length-1?-1:t)+1]).addClass("active"),!1}));break}}))}}(jQuery);